{"version":3,"file":"index.es.js","sources":["../src/sheet.js","../src/index.js"],"sourcesContent":["/*\n\nhigh performance StyleSheet for css-in-js systems\n\n- uses multiple style tags behind the scenes for millions of rules\n- uses `insertRule` for appending in production for *much* faster performance\n- 'polyfills' on server side\n\n// usage\n\nimport StyleSheet from 'glamor/lib/sheet'\nlet styleSheet = new StyleSheet()\n\nstyleSheet.inject()\n- 'injects' the stylesheet into the page (or into memory if on server)\n\nstyleSheet.insert('#box { border: 1px solid red; }')\n- appends a css rule into the stylesheet\n\nstyleSheet.flush()\n- empties the stylesheet of all its contents\n\n*/\n\nimport { forEach } from 'emotion-utils'\n\nfunction last(arr) {\n  return arr[arr.length - 1]\n}\n\nfunction sheetForTag(tag) {\n  if (tag.sheet) {\n    return tag.sheet\n  }\n\n  // this weirdness brought to you by firefox\n  for (let i = 0; i < document.styleSheets.length; i++) {\n    if (document.styleSheets[i].ownerNode === tag) {\n      return document.styleSheets[i]\n    }\n  }\n}\n\nconst isBrowser: boolean = typeof window !== 'undefined'\nconst isDev: boolean =\n  process.env.NODE_ENV === 'development' || !process.env.NODE_ENV // (x => (x === 'development') || !x)(process.env.NODE_ENV)\nconst isTest: boolean = process.env.NODE_ENV === 'test'\n\nconst oldIE = (() => {\n  if (isBrowser) {\n    let div = document.createElement('div')\n    div.innerHTML = '<!--[if lt IE 10]><i></i><![endif]-->'\n    return div.getElementsByTagName('i').length === 1\n  }\n})()\n\nfunction makeStyleTag() {\n  let tag = document.createElement('style')\n  tag.type = 'text/css'\n  tag.setAttribute('data-emotion', '')\n  tag.appendChild(document.createTextNode(''))\n  ;(document.head || document.getElementsByTagName('head')[0]).appendChild(tag)\n  return tag\n}\n\nexport class StyleSheet {\n  constructor(\n    {\n      speedy = !isDev && !isTest,\n      maxLength = isBrowser && oldIE ? 4000 : 65000\n    }: { speedy: boolean, maxLength: number } = {}\n  ) {\n    this.isSpeedy = speedy // the big drawback here is that the css won't be editable in devtools\n    this.sheet = undefined\n    this.tags = []\n    this.maxLength = maxLength\n    this.ctr = 0\n  }\n  getSheet() {\n    return sheetForTag(last(this.tags))\n  }\n  inject() {\n    if (this.injected) {\n      throw new Error('already injected!')\n    }\n    if (isBrowser) {\n      this.tags[0] = makeStyleTag()\n    } else {\n      // server side 'polyfill'. just enough behavior to be useful.\n      this.sheet = {\n        cssRules: [],\n        insertRule: rule => {\n          // enough 'spec compliance' to be able to extract the rules later\n          // in other words, just the cssText field\n          this.sheet.cssRules.push({ cssText: rule })\n        }\n      }\n    }\n    this.injected = true\n  }\n  speedy(bool) {\n    if (this.ctr !== 0) {\n      // cannot change speedy mode after inserting any rule to sheet. Either call speedy(${bool}) earlier in your app, or call flush() before speedy(${bool})\n      throw new Error(`cannot change speedy now`)\n    }\n    this.isSpeedy = !!bool\n  }\n  _insert(rule) {\n    // this weirdness for perf, and chrome's weird bug\n    // https://stackoverflow.com/questions/20007992/chrome-suddenly-stopped-accepting-insertrule\n    try {\n      let sheet = this.getSheet()\n      sheet.insertRule(\n        rule,\n        rule.indexOf('@import') !== -1 ? 0 : sheet.cssRules.length\n      )\n    } catch (e) {\n      if (isDev) {\n        // might need beter dx for this\n        console.warn('illegal rule', rule) // eslint-disable-line no-console\n      }\n    }\n  }\n  insert(rule) {\n    if (isBrowser) {\n      // this is the ultrafast version, works across browsers\n      if (this.isSpeedy && this.getSheet().insertRule) {\n        this._insert(rule)\n      } else {\n        // more browser weirdness. I don't even know\n        // else if(this.tags.length > 0 && this.tags::last().styleSheet) {\n        //   this.tags::last().styleSheet.cssText+= rule\n        // }\n        if (rule.indexOf('@import') !== -1) {\n          const tag = last(this.tags)\n          tag.insertBefore(document.createTextNode(rule), tag.firstChild)\n        } else {\n          last(this.tags).appendChild(document.createTextNode(rule))\n        }\n      }\n    } else {\n      // server side is pretty simple\n      this.sheet.insertRule(\n        rule,\n        rule.indexOf('@import') !== -1 ? 0 : this.sheet.cssRules.length\n      )\n    }\n\n    this.ctr++\n    if (isBrowser && this.ctr % this.maxLength === 0) {\n      this.tags.push(makeStyleTag())\n    }\n    return this.ctr - 1\n  }\n  delete(index) {\n    // we insert a blank rule when 'deleting' so previously returned indexes remain stable\n    return this.replace(index, '')\n  }\n  flush() {\n    if (isBrowser) {\n      forEach(this.tags, tag => tag.parentNode.removeChild(tag))\n      this.tags = []\n      this.sheet = null\n      this.ctr = 0\n      // todo - look for remnants in document.styleSheets\n    } else {\n      // simpler on server\n      this.sheet.cssRules = []\n    }\n    this.injected = false\n  }\n  rules() {\n    if (!isBrowser) {\n      return this.sheet.cssRules\n    }\n    let arr = []\n    forEach(this.tags, tag =>\n      arr.splice(arr.length, 0, ...Array.from(sheetForTag(tag).cssRules))\n    )\n    return arr\n  }\n}\n","// @flow\nimport { StyleSheet } from './sheet'\nimport {\n  forEach,\n  map,\n  reduce,\n  keys,\n  assign,\n  clean,\n  createMarkupForStyles,\n  hashString as hash,\n  hashObject\n} from 'emotion-utils'\n\nexport const sheet = new StyleSheet()\n// üöÄ\nsheet.inject()\n\nexport let inserted: { [string | number]: boolean | void } = {}\n\nexport function flush() {\n  sheet.flush()\n  inserted = {}\n  sheet.inject()\n}\n\n// a simple cache to store generated obj styles\nlet registered = (sheet.registered = {})\n\nfunction register(spec) {\n  if (!registered[spec.id]) {\n    registered[spec.id] = spec\n  }\n}\n\nfunction _getRegistered(rule) {\n  if (isLikeRule(rule)) {\n    let ret = registered[idFor(rule)]\n    if (ret == null) {\n      throw new Error(\n        '[emotion] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79'\n      )\n    }\n    return ret\n  }\n  return rule\n}\n\nfunction buildStyles(objs) {\n  let computedClassName = ''\n  let objectStyles = []\n  // This needs to be moved into the core\n  forEach(objs, (cls): void => {\n    if (typeof cls === 'string') {\n      const match = emotionClassRegex.exec(cls)\n      if (match !== null && ruleCache[match[1]] !== undefined) {\n        objectStyles.push(ruleCache[match[1]])\n      } else {\n        computedClassName && (computedClassName += ' ')\n        computedClassName += cls\n      }\n    } else {\n      objectStyles.push(cls)\n    }\n  })\n\n  return { computedClassName, objectStyles }\n}\n\nexport function css(objs: any, vars: Array<any>, content: () => Array<any>) {\n  if (!Array.isArray(objs)) {\n    objs = [objs]\n  }\n\n  let { computedClassName = '', objectStyles = [] } = buildStyles(\n    content ? objs.concat(content.apply(null, vars)) : objs\n  )\n  if (objectStyles.length) {\n    computedClassName += ' ' + objStyle.apply(null, objectStyles).toString()\n  }\n\n  return computedClassName.trim()\n}\n\nfunction insertRawRule(css: string) {\n  let spec = {\n    id: hash(css),\n    css,\n    type: 'raw'\n  }\n\n  register(spec)\n\n  if (!inserted[spec.id]) {\n    sheet.insert(spec.css)\n    inserted[spec.id] = true\n  }\n}\n\nexport function injectGlobal(\n  objs: Array<any>,\n  vars: Array<any>,\n  content: () => Array<any>\n) {\n  const combined = content ? objs.concat(content.apply(null, vars)) : objs\n  const style = {}\n  build(style, { src: combined })\n  forEach(deconstructedStyleToCSS('', deconstruct(style)), rule => {\n    insertRawRule(rule)\n  })\n}\n\nexport function fontFace(\n  objs: Array<any>,\n  vars: Array<any>,\n  content: () => Array<any>\n) {\n  const combined = reduce(\n    content ? objs.concat(content.apply(null, vars)) : objs,\n    (accum, item, i) => assign(accum, item),\n    {}\n  )\n\n  insertRawRule(`@font-face{${createMarkupForStyles(combined)}}`)\n}\n\nfunction insertKeyframe(spec) {\n  if (!inserted[spec.id]) {\n    const inner = map(\n      keys(spec.keyframes),\n      kf => `${kf} {${createMarkupForStyles(spec.keyframes[kf])}}`\n    ).join('')\n\n    forEach(['-webkit-', ''], prefix =>\n      sheet.insert(`@${prefix}keyframes ${spec.name + '_' + spec.id}{${inner}}`)\n    )\n\n    inserted[spec.id] = true\n  }\n}\n\nexport function keyframes(\n  objs: any,\n  vars: Array<any>,\n  content: () => Array<any>\n) {\n  const [kfs] = content.apply(null, vars)\n  const name = 'animation'\n\n  let spec = {\n    id: hashObject(kfs),\n    type: 'keyframes',\n    name,\n    keyframes: kfs\n  }\n\n  register(spec)\n  insertKeyframe(spec)\n  return `${name}_${spec.id}`\n}\n\nexport function hydrate(ids: string[]) {\n  forEach(ids, id => (inserted[id] = true))\n}\n\ntype EmotionRule = { [string]: any }\n\ntype CSSRuleList = Array<EmotionRule>\n\nlet cachedCss: (rules: CSSRuleList) => EmotionRule =\n  typeof WeakMap !== 'undefined' ? multiIndexCache(_css) : _css\n\n// üç©\n// https://github.com/threepointone/glamor\nexport function objStyle(...rules: CSSRuleList): EmotionRule {\n  rules = clean(rules)\n  if (!rules) {\n    return nullrule\n  }\n\n  return cachedCss(rules)\n}\n\nfunction _css(rules) {\n  let style = {}\n  build(style, { src: rules }) // mutative! but worth it.\n\n  let spec = {\n    id: hashObject(style),\n    style,\n    type: 'css'\n  }\n  return toRule(spec)\n}\n\nconst emotionClassRegex = /^css-([a-zA-Z0-9]+)/\n\n// of shape { 'css-<id>': '' }\nexport function isLikeRule(rule: EmotionRule) {\n  const ruleKeys = keys(rule)\n  if (ruleKeys.length !== 1) {\n    return false\n  }\n  return !!emotionClassRegex.exec(ruleKeys[0])\n}\n\n// extracts id from a { 'css-<id>': ''} like object\nexport function idFor(rule: EmotionRule) {\n  const ruleKeys = keys(rule)\n  if (ruleKeys.length !== 1) throw new Error('not a rule')\n  let match = emotionClassRegex.exec(ruleKeys[0])\n  if (!match) throw new Error('not a rule')\n  return match[1]\n}\n\nconst parentSelectorRegex = /&/gm\n\nfunction selector(parentSelector: string, path: string = '') {\n  if (!parentSelector) {\n    return path.replace(parentSelectorRegex, '')\n  }\n  if (!path) return parentSelector\n\n  let x = map(\n    path.split(','),\n    x =>\n      x.indexOf('&') >= 0\n        ? x.replace(parentSelectorRegex, parentSelector)\n        : parentSelector + x\n  ).join(',')\n\n  return x\n}\n\nfunction deconstruct(style) {\n  // we can be sure it's not infinitely nested here\n  let plain\n  let selects\n  let medias\n  let supports\n\n  forEach(keys(style), key => {\n    if (key.indexOf('&') >= 0) {\n      selects = selects || {}\n      selects[key] = deconstruct(style[key]).plain\n    } else if (key.indexOf('@media') === 0) {\n      medias = medias || {}\n      medias[key] = deconstruct(style[key])\n    } else if (key.indexOf('@supports') === 0) {\n      supports = supports || {}\n      supports[key] = deconstruct(style[key])\n    } else {\n      plain = plain || {}\n\n      plain[key] = style[key]\n    }\n  })\n  return { plain, selects, medias, supports }\n}\n\nfunction deconstructedStyleToCSS(id, style) {\n  let { plain, selects, medias, supports } = style\n  let css = []\n\n  if (plain) {\n    css.push(`${selector(id)}{${createMarkupForStyles(plain)}}`)\n  }\n  if (selects) {\n    forEach(keys(selects), (key: string) =>\n      css.push(`${selector(id, key)}{${createMarkupForStyles(selects[key])}}`)\n    )\n  }\n  if (medias) {\n    forEach(keys(medias), key =>\n      css.push(`${key}{${deconstructedStyleToCSS(id, medias[key]).join('')}}`)\n    )\n  }\n  if (supports) {\n    forEach(keys(supports), key =>\n      css.push(`${key}{${deconstructedStyleToCSS(id, supports[key]).join('')}}`)\n    )\n  }\n  return css\n}\n\n// and helpers to insert rules into said sheet\nfunction insert(spec) {\n  if (!inserted[spec.id]) {\n    inserted[spec.id] = true\n    let deconstructed = deconstruct(spec.style)\n    map(deconstructedStyleToCSS(`.css-${spec.id}`, deconstructed), cssRule =>\n      sheet.insert(cssRule)\n    )\n  }\n}\n\n// todo - perf\nlet ruleCache = {}\n\nfunction toRule(spec) {\n  register(spec)\n  insert(spec)\n  if (ruleCache[spec.id]) {\n    return ruleCache[spec.id]\n  }\n\n  let ret = { [`css-${spec.id}`]: '' }\n  Object.defineProperty(ret, 'toString', {\n    enumerable: false,\n    value() {\n      return 'css-' + spec.id\n    }\n  })\n  ruleCache[spec.id] = ret\n  return ret\n}\n\nfunction isFragment(key) {\n  return key.indexOf('$') === 0\n}\n\nfunction isSelector(val) {\n  return typeof val === 'object'\n}\n\nfunction joinSelectors(a, b) {\n  let as = map(a.split(','), a => (!(a.indexOf('&') >= 0) ? '&' + a : a))\n  let bs = map(b.split(','), b => (!(b.indexOf('&') >= 0) ? '&' + b : b))\n\n  return reduce(\n    bs,\n    (arr, b) => arr.concat(map(as, a => b.replace(parentSelectorRegex, a))),\n    []\n  ).join(',')\n}\n\nfunction joinMediaQueries(a, b) {\n  return a ? `@media ${a.substring(6)} and ${b.substring(6)}` : b\n}\n\nfunction isMediaQuery(key) {\n  return key.indexOf('@media') === 0\n}\n\nfunction isSupports(key) {\n  return key.indexOf('@supports') === 0\n}\n\nfunction joinSupports(a, b) {\n  return a ? `@supports ${a.substring(9)} and ${b.substring(9)}` : b\n}\n\n// flatten a nested array\nfunction flatten(inArr) {\n  let arr = []\n  forEach(inArr, val => {\n    if (Array.isArray(val)) arr = arr.concat(flatten(val))\n    else arr = arr.concat(val)\n  })\n\n  return arr\n}\n\n// mutable! modifies dest.\nfunction build(\n  dest,\n  {\n    selector = '',\n    mq = '',\n    supp = '',\n    src = [{}]\n  }: {\n    selector?: string,\n    mq?: string,\n    supp?: string,\n    src: Array<{ [string]: any }>\n  }\n) {\n  if (!Array.isArray(src)) {\n    src = [src]\n  }\n  src = flatten(src)\n  forEach(src, _src => {\n    if (isLikeRule(_src)) {\n      let reg = _getRegistered(_src)\n      if (reg.type !== 'css') {\n        throw new Error('cannot merge this rule')\n      }\n      _src = reg.style\n    }\n    _src = clean(_src)\n    if (_src && _src.composes) {\n      build(dest, { selector, mq, supp, src: _src.composes })\n    }\n\n    forEach(keys(_src || {}), key => {\n      // replace fragments\n      if (isFragment(key)) {\n        const fragment = _src[key]\n\n        if (typeof fragment === 'string') {\n          const match = emotionClassRegex.exec(fragment)\n          if (match !== null && registered[match[1]]) {\n            const reg = registered[match[1]]\n            if (reg.type !== 'css') {\n              throw new Error('cannot merge this rule')\n            }\n            build(dest, {\n              selector,\n              mq,\n              supp,\n              src: reg.style\n            })\n          }\n        } else {\n          build(dest, {\n            selector,\n            mq,\n            supp,\n            src: fragment\n          })\n        }\n      } else if (isMediaQuery(key)) {\n        build(dest, {\n          selector,\n          mq: joinMediaQueries(mq, key),\n          supp,\n          src: _src[key]\n        })\n      } else if (isSupports(key)) {\n        build(dest, {\n          selector,\n          mq,\n          supp: joinSupports(supp, key),\n          src: _src[key]\n        })\n      } else if (key === 'composes') {\n        // ignore, we already dealt with it\n      } else if (isSelector(_src[key])) {\n        build(dest, {\n          selector: joinSelectors(selector, key),\n          mq,\n          supp,\n          src: _src[key]\n        })\n      } else {\n        let _dest = dest\n        if (supp) {\n          _dest[supp] = _dest[supp] || {}\n          _dest = _dest[supp]\n        }\n        if (mq) {\n          _dest[mq] = _dest[mq] || {}\n          _dest = _dest[mq]\n        }\n        if (selector) {\n          _dest[selector] = _dest[selector] || {}\n          _dest = _dest[selector]\n        }\n\n        _dest[key] = _src[key]\n      }\n    })\n  })\n}\n\nlet nullrule: EmotionRule = {\n  // 'data-css-nil': ''\n}\n\nObject.defineProperty(nullrule, 'toString', {\n  enumerable: false,\n  value() {\n    return 'css-nil'\n  }\n})\n\nlet inputCaches =\n  typeof WeakMap !== 'undefined'\n    ? [nullrule, new WeakMap(), new WeakMap(), new WeakMap()]\n    : [nullrule]\n\nlet warnedWeakMapError = false\n\nfunction multiIndexCache(fn) {\n  return function(args) {\n    if (inputCaches[args.length]) {\n      let coi = inputCaches[args.length]\n      let ctr = 0\n      while (ctr < args.length - 1) {\n        if (!coi.has(args[ctr])) {\n          coi.set(args[ctr], new WeakMap())\n        }\n        coi = coi.get(args[ctr])\n        ctr++\n      }\n      if (coi.has(args[args.length - 1])) {\n        let ret = coi.get(args[ctr])\n\n        if (registered[ret.toString().substring(4)]) {\n          // make sure it hasn't been flushed\n          return ret\n        }\n      }\n    }\n    let value = fn(args)\n    if (inputCaches[args.length]) {\n      let ctr = 0\n      let coi = inputCaches[args.length]\n      while (ctr < args.length - 1) {\n        coi = coi.get(args[ctr])\n        ctr++\n      }\n      try {\n        coi.set(args[ctr], value)\n      } catch (err) {\n        if (\n          (process.env.NODE_ENV === 'development' || !process.env.NODE_ENV) &&\n          !warnedWeakMapError\n        ) {\n          warnedWeakMapError = true\n          console.warn('failed setting the WeakMap cache for args:', ...args) // eslint-disable-line no-console\n          console.warn(\n            'this should NOT happen, please file a bug on the github repo.'\n          ) // eslint-disable-line no-console\n        }\n      }\n    }\n    return value\n  }\n}\n"],"names":["last","arr","length","sheetForTag","tag","sheet","i","document","styleSheets","ownerNode","isBrowser","window","isDev","process","env","NODE_ENV","isTest","oldIE","div","createElement","innerHTML","getElementsByTagName","makeStyleTag","type","setAttribute","appendChild","createTextNode","head","StyleSheet","speedy","maxLength","isSpeedy","undefined","tags","ctr","getSheet","inject","injected","Error","cssRules","push","cssText","rule","bool","_insert","insertRule","indexOf","e","warn","insert","insertBefore","firstChild","delete","index","replace","flush","parentNode","removeChild","rules","splice","Array","from","inserted","registered","register","spec","id","_getRegistered","isLikeRule","ret","idFor","buildStyles","objs","computedClassName","objectStyles","cls","match","emotionClassRegex","exec","ruleCache","css","vars","content","isArray","concat","apply","objStyle","toString","trim","insertRawRule","hash","injectGlobal","combined","style","src","deconstructedStyleToCSS","deconstruct","fontFace","reduce","accum","item","assign","createMarkupForStyles","insertKeyframe","inner","map","keys","keyframes","kf","join","prefix","name","kfs","hashObject","hydrate","ids","cachedCss","WeakMap","multiIndexCache","_css","clean","nullrule","toRule","ruleKeys","parentSelectorRegex","selector","parentSelector","path","x","split","plain","selects","medias","supports","key","deconstructed","cssRule","defineProperty","isFragment","isSelector","val","joinSelectors","a","b","as","bs","joinMediaQueries","substring","isMediaQuery","isSupports","joinSupports","flatten","inArr","build","dest","mq","supp","_src","reg","composes","fragment","_dest","Object","inputCaches","warnedWeakMapError","fn","args","coi","has","set","get","value","err"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,AAEA,SAASA,IAAT,CAAcC,GAAd,EAAmB;SACVA,IAAIA,IAAIC,MAAJ,GAAa,CAAjB,CAAP;;;AAGF,SAASC,WAAT,CAAqBC,GAArB,EAA0B;MACpBA,IAAIC,KAAR,EAAe;WACND,IAAIC,KAAX;;;;OAIG,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,SAASC,WAAT,CAAqBN,MAAzC,EAAiDI,GAAjD,EAAsD;QAChDC,SAASC,WAAT,CAAqBF,CAArB,EAAwBG,SAAxB,KAAsCL,GAA1C,EAA+C;aACtCG,SAASC,WAAT,CAAqBF,CAArB,CAAP;;;;;AAKN,IAAMI,YAAqB,OAAOC,MAAP,KAAkB,WAA7C;AACA,IAAMC,QACJC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,aAAzB,IAA0C,CAACF,QAAQC,GAAR,CAAYC,QADzD;AAEA,IAAMC,SAAkBH,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,MAAjD;;AAEA,IAAME,QAAS,YAAM;MACfP,SAAJ,EAAe;QACTQ,MAAMX,SAASY,aAAT,CAAuB,KAAvB,CAAV;QACIC,SAAJ,GAAgB,uCAAhB;WACOF,IAAIG,oBAAJ,CAAyB,GAAzB,EAA8BnB,MAA9B,KAAyC,CAAhD;;CAJU,EAAd;;AAQA,SAASoB,YAAT,GAAwB;MAClBlB,MAAMG,SAASY,aAAT,CAAuB,OAAvB,CAAV;MACII,IAAJ,GAAW,UAAX;MACIC,YAAJ,CAAiB,cAAjB,EAAiC,EAAjC;MACIC,WAAJ,CAAgBlB,SAASmB,cAAT,CAAwB,EAAxB,CAAhB,EACC,CAACnB,SAASoB,IAAT,IAAiBpB,SAASc,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAAlB,EAA4DI,WAA5D,CAAwErB,GAAxE;SACMA,GAAP;;;AAGF,IAAawB,UAAb;wBAMI;mFAD4C,EAC5C;2BAHEC,MAGF;QAHEA,MAGF,+BAHW,CAACjB,KAAD,IAAU,CAACI,MAGtB;8BAFEc,SAEF;QAFEA,SAEF,kCAFcpB,aAAaO,KAAb,GAAqB,IAArB,GAA4B,KAE1C;;;;SACKc,QAAL,GAAgBF,MAAhB,CADA;SAEKxB,KAAL,GAAa2B,SAAb;SACKC,IAAL,GAAY,EAAZ;SACKH,SAAL,GAAiBA,SAAjB;SACKI,GAAL,GAAW,CAAX;;;uBAEFC,QAbF,uBAaa;WACFhC,YAAYH,KAAK,KAAKiC,IAAV,CAAZ,CAAP;GAdJ;;uBAgBEG,MAhBF,qBAgBW;;;QACH,KAAKC,QAAT,EAAmB;YACX,IAAIC,KAAJ,CAAU,mBAAV,CAAN;;QAEE5B,SAAJ,EAAe;WACRuB,IAAL,CAAU,CAAV,IAAeX,cAAf;KADF,MAEO;;WAEAjB,KAAL,GAAa;kBACD,EADC;oBAEC,0BAAQ;;;gBAGbA,KAAL,CAAWkC,QAAX,CAAoBC,IAApB,CAAyB,EAAEC,SAASC,IAAX,EAAzB;;OALJ;;SASGL,QAAL,GAAgB,IAAhB;GAjCJ;;uBAmCER,MAnCF,mBAmCSc,IAnCT,EAmCe;QACP,KAAKT,GAAL,KAAa,CAAjB,EAAoB;;YAEZ,IAAII,KAAJ,4BAAN;;SAEGP,QAAL,GAAgB,CAAC,CAACY,IAAlB;GAxCJ;;uBA0CEC,OA1CF,oBA0CUF,IA1CV,EA0CgB;;;QAGR;UACErC,QAAQ,KAAK8B,QAAL,EAAZ;YACMU,UAAN,CACEH,IADF,EAEEA,KAAKI,OAAL,CAAa,SAAb,MAA4B,CAAC,CAA7B,GAAiC,CAAjC,GAAqCzC,MAAMkC,QAAN,CAAerC,MAFtD;KAFF,CAME,OAAO6C,CAAP,EAAU;UACNnC,KAAJ,EAAW;;gBAEDoC,IAAR,CAAa,cAAb,EAA6BN,IAA7B,EAFS;;;GApDjB;;uBA0DEO,MA1DF,mBA0DSP,IA1DT,EA0De;QACPhC,SAAJ,EAAe;;UAET,KAAKqB,QAAL,IAAiB,KAAKI,QAAL,GAAgBU,UAArC,EAAiD;aAC1CD,OAAL,CAAaF,IAAb;OADF,MAEO;;;;;YAKDA,KAAKI,OAAL,CAAa,SAAb,MAA4B,CAAC,CAAjC,EAAoC;cAC5B1C,MAAMJ,KAAK,KAAKiC,IAAV,CAAZ;cACIiB,YAAJ,CAAiB3C,SAASmB,cAAT,CAAwBgB,IAAxB,CAAjB,EAAgDtC,IAAI+C,UAApD;SAFF,MAGO;eACA,KAAKlB,IAAV,EAAgBR,WAAhB,CAA4BlB,SAASmB,cAAT,CAAwBgB,IAAxB,CAA5B;;;KAbN,MAgBO;;WAEArC,KAAL,CAAWwC,UAAX,CACEH,IADF,EAEEA,KAAKI,OAAL,CAAa,SAAb,MAA4B,CAAC,CAA7B,GAAiC,CAAjC,GAAqC,KAAKzC,KAAL,CAAWkC,QAAX,CAAoBrC,MAF3D;;;SAMGgC,GAAL;QACIxB,aAAa,KAAKwB,GAAL,GAAW,KAAKJ,SAAhB,KAA8B,CAA/C,EAAkD;WAC3CG,IAAL,CAAUO,IAAV,CAAelB,cAAf;;WAEK,KAAKY,GAAL,GAAW,CAAlB;GAvFJ;;uBAyFEkB,MAzFF,oBAyFSC,KAzFT,EAyFgB;;WAEL,KAAKC,OAAL,CAAaD,KAAb,EAAoB,EAApB,CAAP;GA3FJ;;uBA6FEE,KA7FF,oBA6FU;QACF7C,SAAJ,EAAe;cACL,KAAKuB,IAAb,EAAmB;eAAO7B,IAAIoD,UAAJ,CAAeC,WAAf,CAA2BrD,GAA3B,CAAP;OAAnB;WACK6B,IAAL,GAAY,EAAZ;WACK5B,KAAL,GAAa,IAAb;WACK6B,GAAL,GAAW,CAAX;;KAJF,MAMO;;WAEA7B,KAAL,CAAWkC,QAAX,GAAsB,EAAtB;;SAEGF,QAAL,GAAgB,KAAhB;GAxGJ;;uBA0GEqB,KA1GF,oBA0GU;QACF,CAAChD,SAAL,EAAgB;aACP,KAAKL,KAAL,CAAWkC,QAAlB;;QAEEtC,MAAM,EAAV;YACQ,KAAKgC,IAAb,EAAmB;aACjBhC,IAAI0D,MAAJ,aAAW1D,IAAIC,MAAf,EAAuB,CAAvB,SAA6B0D,MAAMC,IAAN,CAAW1D,YAAYC,GAAZ,EAAiBmC,QAA5B,CAA7B,EADiB;KAAnB;WAGOtC,GAAP;GAlHJ;;;;;ACnDO,IAAMI,QAAQ,IAAIuB,UAAJ,EAAd;;AAEPvB,MAAM+B,MAAN;;AAEA,AAAO,IAAI0B,WAAkD,EAAtD;;AAEP,AAAO,SAASP,KAAT,GAAiB;QAChBA,KAAN;aACW,EAAX;QACMnB,MAAN;;;;AAIF,IAAI2B,aAAc1D,MAAM0D,UAAN,GAAmB,EAArC;;AAEA,SAASC,QAAT,CAAkBC,IAAlB,EAAwB;MAClB,CAACF,WAAWE,KAAKC,EAAhB,CAAL,EAA0B;eACbD,KAAKC,EAAhB,IAAsBD,IAAtB;;;;AAIJ,SAASE,cAAT,CAAwBzB,IAAxB,EAA8B;MACxB0B,WAAW1B,IAAX,CAAJ,EAAsB;QAChB2B,MAAMN,WAAWO,MAAM5B,IAAN,CAAX,CAAV;QACI2B,OAAO,IAAX,EAAiB;YACT,IAAI/B,KAAJ,CACJ,2KADI,CAAN;;WAIK+B,GAAP;;SAEK3B,IAAP;;;AAGF,SAAS6B,WAAT,CAAqBC,IAArB,EAA2B;MACrBC,oBAAoB,EAAxB;MACIC,eAAe,EAAnB;;UAEQF,IAAR,EAAc,UAACG,GAAD,EAAe;QACvB,OAAOA,GAAP,KAAe,QAAnB,EAA6B;UACrBC,QAAQC,kBAAkBC,IAAlB,CAAuBH,GAAvB,CAAd;UACIC,UAAU,IAAV,IAAkBG,UAAUH,MAAM,CAAN,CAAV,MAAwB5C,SAA9C,EAAyD;qBAC1CQ,IAAb,CAAkBuC,UAAUH,MAAM,CAAN,CAAV,CAAlB;OADF,MAEO;8BACiBH,qBAAqB,GAA3C;6BACqBE,GAArB;;KANJ,MAQO;mBACQnC,IAAb,CAAkBmC,GAAlB;;GAVJ;;SAcO,EAAEF,oCAAF,EAAqBC,0BAArB,EAAP;;;AAGF,AAAO,SAASM,GAAT,CAAaR,IAAb,EAAwBS,IAAxB,EAA0CC,OAA1C,EAAqE;MACtE,CAACtB,MAAMuB,OAAN,CAAcX,IAAd,CAAL,EAA0B;WACjB,CAACA,IAAD,CAAP;;;qBAGkDD,YAClDW,UAAUV,KAAKY,MAAL,CAAYF,QAAQG,KAAR,CAAc,IAAd,EAAoBJ,IAApB,CAAZ,CAAV,GAAmDT,IADD,CALsB;2CAKpEC,iBALoE;MAKpEA,iBALoE,yCAKhD,EALgD;2CAK5CC,YAL4C;MAK5CA,YAL4C,yCAK7B,EAL6B;;MAQtEA,aAAaxE,MAAjB,EAAyB;yBACF,MAAMoF,SAASD,KAAT,CAAe,IAAf,EAAqBX,YAArB,EAAmCa,QAAnC,EAA3B;;;SAGKd,kBAAkBe,IAAlB,EAAP;;;AAGF,SAASC,aAAT,CAAuBT,GAAvB,EAAoC;MAC9Bf,OAAO;QACLyB,WAAKV,GAAL,CADK;YAAA;UAGH;GAHR;;WAMSf,IAAT;;MAEI,CAACH,SAASG,KAAKC,EAAd,CAAL,EAAwB;UAChBjB,MAAN,CAAagB,KAAKe,GAAlB;aACSf,KAAKC,EAAd,IAAoB,IAApB;;;;AAIJ,AAAO,SAASyB,YAAT,CACLnB,IADK,EAELS,IAFK,EAGLC,OAHK,EAIL;MACMU,WAAWV,UAAUV,KAAKY,MAAL,CAAYF,QAAQG,KAAR,CAAc,IAAd,EAAoBJ,IAApB,CAAZ,CAAV,GAAmDT,IAApE;MACMqB,QAAQ,EAAd;QACMA,KAAN,EAAa,EAAEC,KAAKF,QAAP,EAAb;UACQG,wBAAwB,EAAxB,EAA4BC,YAAYH,KAAZ,CAA5B,CAAR,EAAyD,gBAAQ;kBACjDnD,IAAd;GADF;;;AAKF,AAAO,SAASuD,QAAT,CACLzB,IADK,EAELS,IAFK,EAGLC,OAHK,EAIL;MACMU,WAAWM,OACfhB,UAAUV,KAAKY,MAAL,CAAYF,QAAQG,KAAR,CAAc,IAAd,EAAoBJ,IAApB,CAAZ,CAAV,GAAmDT,IADpC,EAEf,UAAC2B,KAAD,EAAQC,IAAR,EAAc9F,CAAd;WAAoB+F,OAAOF,KAAP,EAAcC,IAAd,CAApB;GAFe,EAGf,EAHe,CAAjB;;gCAM4BE,sBAAsBV,QAAtB,CAA5B;;;AAGF,SAASW,cAAT,CAAwBtC,IAAxB,EAA8B;MACxB,CAACH,SAASG,KAAKC,EAAd,CAAL,EAAwB;QAChBsC,QAAQC,IACZC,KAAKzC,KAAK0C,SAAV,CADY,EAEZ;aAASC,EAAT,UAAgBN,sBAAsBrC,KAAK0C,SAAL,CAAeC,EAAf,CAAtB,CAAhB;KAFY,EAGZC,IAHY,CAGP,EAHO,CAAd;;YAKQ,CAAC,UAAD,EAAa,EAAb,CAAR,EAA0B;aACxBxG,MAAM4C,MAAN,OAAiB6D,MAAjB,mBAAoC7C,KAAK8C,IAAL,GAAY,GAAZ,GAAkB9C,KAAKC,EAA3D,UAAiEsC,KAAjE,OADwB;KAA1B;;aAISvC,KAAKC,EAAd,IAAoB,IAApB;;;;AAIJ,AAAO,SAASyC,SAAT,CACLnC,IADK,EAELS,IAFK,EAGLC,OAHK,EAIL;uBACcA,QAAQG,KAAR,CAAc,IAAd,EAAoBJ,IAApB,CADd;MACO+B,GADP;;MAEMD,OAAO,WAAb;;MAEI9C,OAAO;QACLgD,WAAWD,GAAX,CADK;UAEH,WAFG;cAAA;eAIEA;GAJb;;WAOS/C,IAAT;iBACeA,IAAf;SACU8C,IAAV,SAAkB9C,KAAKC,EAAvB;;;AAGF,AAAO,SAASgD,OAAT,CAAiBC,GAAjB,EAAgC;UAC7BA,GAAR,EAAa;WAAOrD,SAASI,EAAT,IAAe,IAAtB;GAAb;;;AAOF,IAAIkD,YACF,OAAOC,OAAP,KAAmB,WAAnB,GAAiCC,gBAAgBC,IAAhB,CAAjC,GAAyDA,IAD3D;;;;AAKA,AAAO,SAASjC,QAAT,GAAsD;oCAAjC5B,KAAiC;SAAA;;;UACnD8D,MAAM9D,KAAN,CAAR;MACI,CAACA,KAAL,EAAY;WACH+D,QAAP;;;SAGKL,UAAU1D,KAAV,CAAP;;;AAGF,SAAS6D,IAAT,CAAc7D,KAAd,EAAqB;MACfmC,QAAQ,EAAZ;QACMA,KAAN,EAAa,EAAEC,KAAKpC,KAAP,EAAb,EAFmB;;MAIfO,OAAO;QACLgD,WAAWpB,KAAX,CADK;gBAAA;UAGH;GAHR;SAKO6B,OAAOzD,IAAP,CAAP;;;AAGF,IAAMY,oBAAoB,qBAA1B;;;AAGA,AAAO,SAAST,UAAT,CAAoB1B,IAApB,EAAuC;MACtCiF,WAAWjB,KAAKhE,IAAL,CAAjB;MACIiF,SAASzH,MAAT,KAAoB,CAAxB,EAA2B;WAClB,KAAP;;SAEK,CAAC,CAAC2E,kBAAkBC,IAAlB,CAAuB6C,SAAS,CAAT,CAAvB,CAAT;;;;AAIF,AAAO,SAASrD,KAAT,CAAe5B,IAAf,EAAkC;MACjCiF,WAAWjB,KAAKhE,IAAL,CAAjB;MACIiF,SAASzH,MAAT,KAAoB,CAAxB,EAA2B,MAAM,IAAIoC,KAAJ,CAAU,YAAV,CAAN;MACvBsC,QAAQC,kBAAkBC,IAAlB,CAAuB6C,SAAS,CAAT,CAAvB,CAAZ;MACI,CAAC/C,KAAL,EAAY,MAAM,IAAItC,KAAJ,CAAU,YAAV,CAAN;SACLsC,MAAM,CAAN,CAAP;;;AAGF,IAAMgD,sBAAsB,KAA5B;;AAEA,SAASC,QAAT,CAAkBC,cAAlB,EAA6D;MAAnBC,IAAmB,uEAAJ,EAAI;;MACvD,CAACD,cAAL,EAAqB;WACZC,KAAKzE,OAAL,CAAasE,mBAAb,EAAkC,EAAlC,CAAP;;MAEE,CAACG,IAAL,EAAW,OAAOD,cAAP;;MAEPE,IAAIvB,IACNsB,KAAKE,KAAL,CAAW,GAAX,CADM,EAEN;WACED,EAAElF,OAAF,CAAU,GAAV,KAAkB,CAAlB,GACIkF,EAAE1E,OAAF,CAAUsE,mBAAV,EAA+BE,cAA/B,CADJ,GAEIA,iBAAiBE,CAHvB;GAFM,EAMNnB,IANM,CAMD,GANC,CAAR;;SAQOmB,CAAP;;;AAGF,SAAShC,WAAT,CAAqBH,KAArB,EAA4B;;MAEtBqC,cAAJ;MACIC,gBAAJ;MACIC,eAAJ;MACIC,iBAAJ;;UAEQ3B,KAAKb,KAAL,CAAR,EAAqB,eAAO;QACtByC,IAAIxF,OAAJ,CAAY,GAAZ,KAAoB,CAAxB,EAA2B;gBACfqF,WAAW,EAArB;cACQG,GAAR,IAAetC,YAAYH,MAAMyC,GAAN,CAAZ,EAAwBJ,KAAvC;KAFF,MAGO,IAAII,IAAIxF,OAAJ,CAAY,QAAZ,MAA0B,CAA9B,EAAiC;eAC7BsF,UAAU,EAAnB;aACOE,GAAP,IAActC,YAAYH,MAAMyC,GAAN,CAAZ,CAAd;KAFK,MAGA,IAAIA,IAAIxF,OAAJ,CAAY,WAAZ,MAA6B,CAAjC,EAAoC;iBAC9BuF,YAAY,EAAvB;eACSC,GAAT,IAAgBtC,YAAYH,MAAMyC,GAAN,CAAZ,CAAhB;KAFK,MAGA;cACGJ,SAAS,EAAjB;;YAEMI,GAAN,IAAazC,MAAMyC,GAAN,CAAb;;GAbJ;SAgBO,EAAEJ,YAAF,EAASC,gBAAT,EAAkBC,cAAlB,EAA0BC,kBAA1B,EAAP;;;AAGF,SAAStC,uBAAT,CAAiC7B,EAAjC,EAAqC2B,KAArC,EAA4C;MACpCqC,KADoC,GACCrC,KADD,CACpCqC,KADoC;MAC7BC,OAD6B,GACCtC,KADD,CAC7BsC,OAD6B;MACpBC,MADoB,GACCvC,KADD,CACpBuC,MADoB;MACZC,QADY,GACCxC,KADD,CACZwC,QADY;;MAEtCrD,MAAM,EAAV;;MAEIkD,KAAJ,EAAW;QACL1F,IAAJ,CAAYqF,SAAS3D,EAAT,CAAZ,SAA4BoC,sBAAsB4B,KAAtB,CAA5B;;MAEEC,OAAJ,EAAa;YACHzB,KAAKyB,OAAL,CAAR,EAAuB,UAACG,GAAD;aACrBtD,IAAIxC,IAAJ,CAAYqF,SAAS3D,EAAT,EAAaoE,GAAb,CAAZ,SAAiChC,sBAAsB6B,QAAQG,GAAR,CAAtB,CAAjC,OADqB;KAAvB;;MAIEF,MAAJ,EAAY;YACF1B,KAAK0B,MAAL,CAAR,EAAsB;aACpBpD,IAAIxC,IAAJ,CAAY8F,GAAZ,SAAmBvC,wBAAwB7B,EAAxB,EAA4BkE,OAAOE,GAAP,CAA5B,EAAyCzB,IAAzC,CAA8C,EAA9C,CAAnB,OADoB;KAAtB;;MAIEwB,QAAJ,EAAc;YACJ3B,KAAK2B,QAAL,CAAR,EAAwB;aACtBrD,IAAIxC,IAAJ,CAAY8F,GAAZ,SAAmBvC,wBAAwB7B,EAAxB,EAA4BmE,SAASC,GAAT,CAA5B,EAA2CzB,IAA3C,CAAgD,EAAhD,CAAnB,OADsB;KAAxB;;SAIK7B,GAAP;;;;AAIF,SAAS/B,MAAT,CAAgBgB,IAAhB,EAAsB;MAChB,CAACH,SAASG,KAAKC,EAAd,CAAL,EAAwB;aACbD,KAAKC,EAAd,IAAoB,IAApB;QACIqE,gBAAgBvC,YAAY/B,KAAK4B,KAAjB,CAApB;QACIE,kCAAgC9B,KAAKC,EAArC,EAA2CqE,aAA3C,CAAJ,EAA+D;aAC7DlI,MAAM4C,MAAN,CAAauF,OAAb,CAD6D;KAA/D;;;;;AAOJ,IAAIzD,YAAY,EAAhB;;AAEA,SAAS2C,MAAT,CAAgBzD,IAAhB,EAAsB;;;WACXA,IAAT;SACOA,IAAP;MACIc,UAAUd,KAAKC,EAAf,CAAJ,EAAwB;WACfa,UAAUd,KAAKC,EAAf,CAAP;;;MAGEG,gCAAgBJ,KAAKC,EAArB,IAA4B,EAA5B,OAAJ;SACOuE,cAAP,CAAsBpE,GAAtB,EAA2B,UAA3B,EAAuC;gBACzB,KADyB;SAAA,mBAE7B;aACC,SAASJ,KAAKC,EAArB;;GAHJ;YAMUD,KAAKC,EAAf,IAAqBG,GAArB;SACOA,GAAP;;;AAGF,SAASqE,UAAT,CAAoBJ,GAApB,EAAyB;SAChBA,IAAIxF,OAAJ,CAAY,GAAZ,MAAqB,CAA5B;;;AAGF,SAAS6F,UAAT,CAAoBC,GAApB,EAAyB;SAChB,OAAOA,GAAP,KAAe,QAAtB;;;AAGF,SAASC,aAAT,CAAuBC,CAAvB,EAA0BC,CAA1B,EAA6B;MACvBC,KAAKvC,IAAIqC,EAAEb,KAAF,CAAQ,GAAR,CAAJ,EAAkB;WAAM,EAAEa,EAAEhG,OAAF,CAAU,GAAV,KAAkB,CAApB,IAAyB,MAAMgG,CAA/B,GAAmCA,CAAzC;GAAlB,CAAT;MACIG,KAAKxC,IAAIsC,EAAEd,KAAF,CAAQ,GAAR,CAAJ,EAAkB;WAAM,EAAEc,EAAEjG,OAAF,CAAU,GAAV,KAAkB,CAApB,IAAyB,MAAMiG,CAA/B,GAAmCA,CAAzC;GAAlB,CAAT;;SAEO7C,OACL+C,EADK,EAEL,UAAChJ,GAAD,EAAM8I,CAAN;WAAY9I,IAAImF,MAAJ,CAAWqB,IAAIuC,EAAJ,EAAQ;aAAKD,EAAEzF,OAAF,CAAUsE,mBAAV,EAA+BkB,CAA/B,CAAL;KAAR,CAAX,CAAZ;GAFK,EAGL,EAHK,EAILjC,IAJK,CAIA,GAJA,CAAP;;;AAOF,SAASqC,gBAAT,CAA0BJ,CAA1B,EAA6BC,CAA7B,EAAgC;SACvBD,gBAAcA,EAAEK,SAAF,CAAY,CAAZ,CAAd,aAAoCJ,EAAEI,SAAF,CAAY,CAAZ,CAApC,GAAuDJ,CAA9D;;;AAGF,SAASK,YAAT,CAAsBd,GAAtB,EAA2B;SAClBA,IAAIxF,OAAJ,CAAY,QAAZ,MAA0B,CAAjC;;;AAGF,SAASuG,UAAT,CAAoBf,GAApB,EAAyB;SAChBA,IAAIxF,OAAJ,CAAY,WAAZ,MAA6B,CAApC;;;AAGF,SAASwG,YAAT,CAAsBR,CAAtB,EAAyBC,CAAzB,EAA4B;SACnBD,mBAAiBA,EAAEK,SAAF,CAAY,CAAZ,CAAjB,aAAuCJ,EAAEI,SAAF,CAAY,CAAZ,CAAvC,GAA0DJ,CAAjE;;;;AAIF,SAASQ,OAAT,CAAiBC,KAAjB,EAAwB;MAClBvJ,MAAM,EAAV;UACQuJ,KAAR,EAAe,eAAO;QAChB5F,MAAMuB,OAAN,CAAcyD,GAAd,CAAJ,EAAwB3I,MAAMA,IAAImF,MAAJ,CAAWmE,QAAQX,GAAR,CAAX,CAAN,CAAxB,KACK3I,MAAMA,IAAImF,MAAJ,CAAWwD,GAAX,CAAN;GAFP;;SAKO3I,GAAP;;;;AAIF,SAASwJ,KAAT,CACEC,IADF,QAaE;2BAVE7B,QAUF;MAVEA,QAUF,iCAVa,EAUb;qBATE8B,EASF;MATEA,EASF,2BATO,EASP;uBAREC,IAQF;MAREA,IAQF,6BARS,EAQT;sBAPE9D,GAOF;MAPEA,GAOF,4BAPQ,CAAC,EAAD,CAOR;;MACI,CAAClC,MAAMuB,OAAN,CAAcW,GAAd,CAAL,EAAyB;UACjB,CAACA,GAAD,CAAN;;QAEIyD,QAAQzD,GAAR,CAAN;UACQA,GAAR,EAAa,gBAAQ;QACf1B,WAAWyF,IAAX,CAAJ,EAAsB;UAChBC,MAAM3F,eAAe0F,IAAf,CAAV;UACIC,IAAIvI,IAAJ,KAAa,KAAjB,EAAwB;cAChB,IAAIe,KAAJ,CAAU,wBAAV,CAAN;;aAEKwH,IAAIjE,KAAX;;WAEK2B,MAAMqC,IAAN,CAAP;QACIA,QAAQA,KAAKE,QAAjB,EAA2B;YACnBL,IAAN,EAAY,EAAE7B,kBAAF,EAAY8B,MAAZ,EAAgBC,UAAhB,EAAsB9D,KAAK+D,KAAKE,QAAhC,EAAZ;;;YAGMrD,KAAKmD,QAAQ,EAAb,CAAR,EAA0B,eAAO;;UAE3BnB,WAAWJ,GAAX,CAAJ,EAAqB;YACb0B,WAAWH,KAAKvB,GAAL,CAAjB;;YAEI,OAAO0B,QAAP,KAAoB,QAAxB,EAAkC;cAC1BpF,QAAQC,kBAAkBC,IAAlB,CAAuBkF,QAAvB,CAAd;cACIpF,UAAU,IAAV,IAAkBb,WAAWa,MAAM,CAAN,CAAX,CAAtB,EAA4C;gBACpCkF,OAAM/F,WAAWa,MAAM,CAAN,CAAX,CAAZ;gBACIkF,KAAIvI,IAAJ,KAAa,KAAjB,EAAwB;oBAChB,IAAIe,KAAJ,CAAU,wBAAV,CAAN;;kBAEIoH,IAAN,EAAY;gCAAA;oBAAA;wBAAA;mBAILI,KAAIjE;aAJX;;SAPJ,MAcO;gBACC6D,IAAN,EAAY;8BAAA;kBAAA;sBAAA;iBAILM;WAJP;;OAlBJ,MAyBO,IAAIZ,aAAad,GAAb,CAAJ,EAAuB;cACtBoB,IAAN,EAAY;4BAAA;cAENR,iBAAiBS,EAAjB,EAAqBrB,GAArB,CAFM;oBAAA;eAILuB,KAAKvB,GAAL;SAJP;OADK,MAOA,IAAIe,WAAWf,GAAX,CAAJ,EAAqB;cACpBoB,IAAN,EAAY;4BAAA;gBAAA;gBAGJJ,aAAaM,IAAb,EAAmBtB,GAAnB,CAHI;eAILuB,KAAKvB,GAAL;SAJP;OADK,MAOA,IAAIA,QAAQ,UAAZ,EAAwB;;OAAxB,MAEA,IAAIK,WAAWkB,KAAKvB,GAAL,CAAX,CAAJ,EAA2B;cAC1BoB,IAAN,EAAY;oBACAb,cAAchB,QAAd,EAAwBS,GAAxB,CADA;gBAAA;oBAAA;eAILuB,KAAKvB,GAAL;SAJP;OADK,MAOA;YACD2B,QAAQP,IAAZ;YACIE,IAAJ,EAAU;gBACFA,IAAN,IAAcK,MAAML,IAAN,KAAe,EAA7B;kBACQK,MAAML,IAAN,CAAR;;YAEED,EAAJ,EAAQ;gBACAA,EAAN,IAAYM,MAAMN,EAAN,KAAa,EAAzB;kBACQM,MAAMN,EAAN,CAAR;;YAEE9B,QAAJ,EAAc;gBACNA,QAAN,IAAkBoC,MAAMpC,QAAN,KAAmB,EAArC;kBACQoC,MAAMpC,QAAN,CAAR;;;cAGIS,GAAN,IAAauB,KAAKvB,GAAL,CAAb;;KAjEJ;GAbF;;;AAoFF,IAAIb,WAAwB;;CAA5B;;AAIAyC,OAAOzB,cAAP,CAAsBhB,QAAtB,EAAgC,UAAhC,EAA4C;cAC9B,KAD8B;OAAA,mBAElC;WACC,SAAP;;CAHJ;;AAOA,IAAI0C,cACF,OAAO9C,OAAP,KAAmB,WAAnB,GACI,CAACI,QAAD,EAAW,IAAIJ,OAAJ,EAAX,EAA0B,IAAIA,OAAJ,EAA1B,EAAyC,IAAIA,OAAJ,EAAzC,CADJ,GAEI,CAACI,QAAD,CAHN;;AAKA,IAAI2C,qBAAqB,KAAzB;;AAEA,SAAS9C,eAAT,CAAyB+C,EAAzB,EAA6B;SACpB,UAASC,IAAT,EAAe;QAChBH,YAAYG,KAAKpK,MAAjB,CAAJ,EAA8B;UACxBqK,MAAMJ,YAAYG,KAAKpK,MAAjB,CAAV;UACIgC,MAAM,CAAV;aACOA,MAAMoI,KAAKpK,MAAL,GAAc,CAA3B,EAA8B;YACxB,CAACqK,IAAIC,GAAJ,CAAQF,KAAKpI,GAAL,CAAR,CAAL,EAAyB;cACnBuI,GAAJ,CAAQH,KAAKpI,GAAL,CAAR,EAAmB,IAAImF,OAAJ,EAAnB;;cAEIkD,IAAIG,GAAJ,CAAQJ,KAAKpI,GAAL,CAAR,CAAN;;;UAGEqI,IAAIC,GAAJ,CAAQF,KAAKA,KAAKpK,MAAL,GAAc,CAAnB,CAAR,CAAJ,EAAoC;YAC9BmE,MAAMkG,IAAIG,GAAJ,CAAQJ,KAAKpI,GAAL,CAAR,CAAV;;YAEI6B,WAAWM,IAAIkB,QAAJ,GAAe4D,SAAf,CAAyB,CAAzB,CAAX,CAAJ,EAA6C;;iBAEpC9E,GAAP;;;;QAIFsG,QAAQN,GAAGC,IAAH,CAAZ;QACIH,YAAYG,KAAKpK,MAAjB,CAAJ,EAA8B;UACxBgC,OAAM,CAAV;UACIqI,OAAMJ,YAAYG,KAAKpK,MAAjB,CAAV;aACOgC,OAAMoI,KAAKpK,MAAL,GAAc,CAA3B,EAA8B;eACtBqK,KAAIG,GAAJ,CAAQJ,KAAKpI,IAAL,CAAR,CAAN;;;UAGE;aACEuI,GAAJ,CAAQH,KAAKpI,IAAL,CAAR,EAAmByI,KAAnB;OADF,CAEE,OAAOC,GAAP,EAAY;YAEV,CAAC/J,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,aAAzB,IAA0C,CAACF,QAAQC,GAAR,CAAYC,QAAxD,KACA,CAACqJ,kBAFH,EAGE;;;+BACqB,IAArB;+BACQpH,IAAR,kBAAa,4CAAb,SAA8DsH,IAA9D,GAFA;kBAGQtH,IAAR,CACE,+DADF,EAHA;;;;WASC2H,KAAP;GA3CF;;;;;"}